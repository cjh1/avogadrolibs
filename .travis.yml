branches:
  only:
    - wheels

language: cpp

sudo: true

matrix:
  allow_failures:
    - os: osx

  include:
    - language: python
      sudo: false
      python: 2.7
      env: TASKS="clang-format"

      os: linux
      dist: trusty
      addons:
        apt:
          sources:
          - ubuntu-toolchain-r-test
          - llvm-toolchain-trusty-6.0
          packages:
          - clang-format-6.0
      if: branch = master
    - compiler: gcc
      os: linux
      addons:
        apt:
          sources: ubuntu-toolchain-r-test
          packages: g++-4.9
      env:
        - TASKS="ctest gcc-4.9"
        - MATRIX_EVAL="CC=gcc-4.9 && CXX=g++-4.9"
      if: branch = master
    - compiler: gcc
      os: linux
      addons:
        apt:
          sources: ubuntu-toolchain-r-test
          packages: g++-6
      env:
        - TASKS="ctest gcc-6.3"
        - MATRIX_EVAL="CC=gcc-6 && CXX=g++-6"
      if: branch = master
    - compiler: clang
      os: linux
      env: TASKS="ctest clang-3.9"
      if: branch = master
    - os: osx
      env: TASKS="Mac clang"
      if: branch = master

    - os: osx
      env: DEPLOY=TRUE


install: true
#  - . ./scripts/travis/install.sh

script: true
#  - ./scripts/travis/build.sh

#before_deploy:
#  - ./scripts/travis/deploy.sh 

deploy:
  provider: script
  script: bash ./scripts/travis/deploy.sh
  on:
    branch: wheels
    condition: $DEPLOY=TRUE
 
